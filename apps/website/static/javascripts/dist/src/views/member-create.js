define(["jquery","underscore","backbone"],function(e,t,r){var i=r.View.extend({el:"#form-container",maxFieldset:1,currentFieldset:0,initialize:function(){console.log("MemberCreateView initialize"),this.renderMultistepFormHeader(),this.renderCurrentFieldset()},events:{"keydown input[type=text]":"removeRequiredError","keydown input[type=email]":"removeRequiredError","click #btn-back":"handleBack","click #btn-next":"handleNext","change #id_email":"validateEmail","click #btn-submit":"checkRequired","click #next":"renderNextFieldset"},handleBack:function(e){e.preventDefault(),this.currentFieldset-=1,this.renderMultistepFormHeader(),this.renderCurrentFieldset()},handleNext:function(e){e.preventDefault(),this.validateRequired()&&(this.currentFieldset+=1,this.renderMultistepFormHeader(),this.renderCurrentFieldset())},renderMultistepFormHeader:function(){var r=this;t.forEach(e(".multistep-form-header").find("li"),function(t,i){i===r.currentFieldset?e(t).addClass("active"):e(t).removeClass("active")})},renderCurrentFieldset:function(){var r=this;t.forEach(e("fieldset"),function(t,i){i===r.currentFieldset?e(t).removeClass("hidden"):e(t).addClass("hidden")}),this.currentFieldset==this.maxFieldset?(e("#btn-submit").removeClass("hidden"),e("#btn-next").addClass("hidden")):(e("#btn-submit").addClass("hidden"),e("#btn-next").removeClass("hidden")),0==this.currentFieldset?e("#btn-back").addClass("hidden"):e("#btn-back").removeClass("hidden")},removeRequiredError:function(t){""!=e(t.currentTarget).val()&&(e(t.currentTarget).parent().removeClass("has-error"),e(t.currentTarget).tooltip("destroy"))},validateRequired:function(){var r=this,i=!0;return t.forEach(e("input,textarea,select").filter("[required]:visible"),function(t){var t=e(t);""===t.val()&&(i=!1,r.signalError(t,"This field is required."))}),i},checkRequired:function(t){t.preventDefault(),this.validateRequired()&&e("form").submit()},validateEmail:function(){var t=e("#id_email"),r=t.val(),i=r.indexOf("@"),n=r.lastIndexOf(".");1>i||i+2>n||n+2>=r.length?this.signalError(t,"Not a valid e-mail address."):this.signalSuccess(t)},signalError:function(e,t){e.parent().removeClass("has-success"),e.parent().addClass("has-error"),e.tooltip({trigger:"manual",placement:"bottom",title:t}).tooltip("show")},signalSuccess:function(e){e.parent().removeClass("has-error"),e.parent().addClass("has-success"),e.tooltip("destroy")}});return i});