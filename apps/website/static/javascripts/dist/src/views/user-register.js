define(["jquery","underscore","backbone"],function(e,r,s){var a=s.View.extend({el:"#register-container",initialize:function(){console.log("UserRegisterView initialize")},events:{"change #username":"validateUsername","change #email":"validateEmail","change #password2":"validatePasswords","keydown #username":"removeRequiredError","keydown #email":"removeRequiredError","keydown #password1":"removeRequiredError","keydown #password2":"removeRequiredError","click #btn-submit":"checkRequired"},validateUsername:function(){var r=this,s={username:e("#username").val()};e.ajax({url:"/api/users/exists/",type:"POST",data:s,success:function(s){$username=e("#username"),s.exists?r.signalError($username,"Username is already taken."):r.signalSuccess($username)}})},validateEmail:function(){var r=e("#email"),s=r.val(),a=s.indexOf("@"),i=s.lastIndexOf(".");1>a||a+2>i||i+2>=s.length?this.signalError(r,"Not a valid e-mail address."):this.signalSuccess(r)},validatePasswords:function(){password1=e("#password1").val(),password2=e("#password2").val(),password1!=password2?(this.signalError(e("#password2"),"Passwords must match."),this.signalError(e("#password1"),"")):(this.signalSuccess(e("#password1")),this.signalSuccess(e("#password2")))},removeRequiredError:function(r){""!=e(r.currentTarget).val()&&(e(r.currentTarget).parent().removeClass("has-error"),e(r.currentTarget).tooltip("destroy"))},checkRequired:function(s){s.preventDefault();var a=this,i=!0;r.forEach(e("input,textarea,select").filter("[required]:visible"),function(r){var r=e(r);""===r.val()&&(i=!1,a.signalError(r,"This field is required."))}),i&&e("form").submit()},signalError:function(e,r){e.parent().removeClass("has-success"),e.parent().addClass("has-error"),e.tooltip({trigger:"manual",placement:"bottom",title:r}).tooltip("show")},signalSuccess:function(e){e.parent().removeClass("has-error"),e.parent().addClass("has-success"),e.tooltip("destroy")}});return a});